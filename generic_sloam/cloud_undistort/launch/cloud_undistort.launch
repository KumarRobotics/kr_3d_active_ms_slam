<?xml version="1.0" encoding="UTF-8"?>
<launch>

    <arg name="robot" default="quadrotor" />
    <arg name="robot_frame_id" default="$(arg robot)/base_link" />
    <arg name="cam_frame_id" default="$(arg robot)/odom" />
    <!-- undistort node params -->
    <arg name="laser_ns" default="os_cloud_node" />
    <arg name="imu_topic" default="/os_cloud_node/imu" />
    <arg name="cloud" default="/os_node/segmented_point_cloud_organized" />
    <!-- ouster node params -->
    <arg name="ouster_metadata" default="/opt/bags/ouster_metadata.json" />
    <arg name="offline_ouster" default="true" />
    <arg name="output_topic_name" default="/os_node/segmented_cloud_undistorted" />


    <node pkg="cloud_undistort" type="cloud_undistort" name="cloud_undistort" output="screen" ns="$(arg laser_ns)">
        <remap from="~imu" to="$(arg imu_topic)" />
        <remap from="~cloud" to="$(arg cloud)" />
        <remap from="~cloud_undistort" to="$(arg output_topic_name)" />
    </node>

    <!--- Run Ouster-->
    <include file="$(find ouster_ros)/ouster.launch">
        <arg name="metadata" value="$(arg ouster_metadata)" />
        <arg name="replay" value="$(arg offline_ouster)" />
    </include>

    <!-- <include file="$(find ouster_decoder)/launch/driver.launch">
        <arg name="metadata"      value="$(arg ouster_metadata)"/>
        <arg name="replay"      value="$(arg offline_ouster)"/>
        <arg name="lidar_mode"      value="2048x10"/>
    </include>

    <include file="$(find ouster_decoder)/launch/decoder.launch">
        <arg name="destagger"     value="false"/>
    </include> -->


    <!-- <node pkg="tf2_ros" type="static_transform_publisher"
    name="fla3_base_link_camera_tf"
    args="0 0 0 0 0 1.26 $(arg cam_frame_id) $(arg robot_frame_id)" /> -->
</launch>
